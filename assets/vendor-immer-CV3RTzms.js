var B=Symbol.for("immer-nothing"),T=Symbol.for("immer-draftable"),s=Symbol.for("immer-state");function u(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var d=Object.getPrototypeOf;function h(e){return!!e&&!!e[s]}function _(e){return e?U(e)||Array.isArray(e)||!!e[T]||!!e.constructor?.[T]||P(e)||O(e):!1}var Q=Object.prototype.constructor.toString();function U(e){if(!e||typeof e!="object")return!1;const r=d(e);if(r===null)return!0;const t=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===Q}function z(e,r){F(e)===0?Reflect.ownKeys(e).forEach(t=>{r(t,e[t],e)}):e.forEach((t,n)=>r(n,t,e))}function F(e){const r=e[s];return r?r.type_:Array.isArray(e)?1:P(e)?2:O(e)?3:0}function C(e,r){return F(e)===2?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function G(e,r,t){const n=F(e);n===2?e.set(r,t):n===3?e.add(t):e[r]=t}function Y(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}function P(e){return e instanceof Map}function O(e){return e instanceof Set}function l(e){return e.copy_||e.base_}function b(e,r){if(P(e))return new Map(e);if(O(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const t=U(e);if(r===!0||r==="class_only"&&!t){const n=Object.getOwnPropertyDescriptors(e);delete n[s];let i=Reflect.ownKeys(n);for(let o=0;o<i.length;o++){const f=i[o],c=n[f];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[f]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[f]})}return Object.create(d(e),n)}else{const n=d(e);if(n!==null&&t)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function N(e,r=!1){return A(e)||h(e)||!_(e)||(F(e)>1&&Object.defineProperties(e,{set:{value:w},add:{value:w},clear:{value:w},delete:{value:w}}),Object.freeze(e),r&&Object.values(e).forEach(t=>N(t,!0))),e}function w(){u(2)}function A(e){return Object.isFrozen(e)}var Z={};function y(e){const r=Z[e];return r||u(0,e),r}var m;function H(){return m}function L(e,r){return{drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function x(e,r){r&&(y("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function k(e){E(e),e.drafts_.forEach(V),e.drafts_=null}function E(e){e===m&&(m=e.parent_)}function j(e){return m=L(m,e)}function V(e){const r=e[s];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function K(e,r){r.unfinalizedDrafts_=r.drafts_.length;const t=r.drafts_[0];return e!==void 0&&e!==t?(t[s].modified_&&(k(r),u(4)),_(e)&&(e=g(r,e),r.parent_||S(r,e)),r.patches_&&y("Patches").generateReplacementPatches_(t[s].base_,e,r.patches_,r.inversePatches_)):e=g(r,t,[]),k(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==B?e:void 0}function g(e,r,t){if(A(r))return r;const n=r[s];if(!n)return z(r,(i,o)=>W(e,n,r,i,o,t)),r;if(n.scope_!==e)return r;if(!n.modified_)return S(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let o=i,f=!1;n.type_===3&&(o=new Set(i),i.clear(),f=!0),z(o,(c,a)=>W(e,n,i,c,a,t,f)),S(e,i,!1),t&&e.patches_&&y("Patches").generatePatches_(n,t,e.patches_,e.inversePatches_)}return n.copy_}function W(e,r,t,n,i,o,f){if(h(i)){const c=o&&r&&r.type_!==3&&!C(r.assigned_,n)?o.concat(n):void 0,a=g(e,i,c);if(G(t,n,a),h(a))e.canAutoFreeze_=!1;else return}else f&&t.add(i);if(_(i)&&!A(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;g(e,i),(!r||!r.scope_.parent_)&&typeof n!="symbol"&&(P(t)?t.has(n):Object.prototype.propertyIsEnumerable.call(t,n))&&S(e,i)}}function S(e,r,t=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&N(r,t)}function ee(e,r){const t=Array.isArray(e),n={type_:t?1:0,scope_:r?r.scope_:H(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,o=I;t&&(i=[n],o=p);const{revoke:f,proxy:c}=Proxy.revocable(i,o);return n.draft_=c,n.revoke_=f,c}var I={get(e,r){if(r===s)return e;const t=l(e);if(!C(t,r))return re(e,t,r);const n=t[r];return e.finalized_||!_(n)?n:n===v(e.base_,r)?(D(e),e.copy_[r]=M(n,e)):n},has(e,r){return r in l(e)},ownKeys(e){return Reflect.ownKeys(l(e))},set(e,r,t){const n=X(l(e),r);if(n?.set)return n.set.call(e.draft_,t),!0;if(!e.modified_){const i=v(l(e),r),o=i?.[s];if(o&&o.base_===t)return e.copy_[r]=t,e.assigned_[r]=!1,!0;if(Y(t,i)&&(t!==void 0||C(e.base_,r)))return!0;D(e),R(e)}return e.copy_[r]===t&&(t!==void 0||r in e.copy_)||Number.isNaN(t)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=t,e.assigned_[r]=!0),!0},deleteProperty(e,r){return v(e.base_,r)!==void 0||r in e.base_?(e.assigned_[r]=!1,D(e),R(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const t=l(e),n=Reflect.getOwnPropertyDescriptor(t,r);return n&&{writable:!0,configurable:e.type_!==1||r!=="length",enumerable:n.enumerable,value:t[r]}},defineProperty(){u(11)},getPrototypeOf(e){return d(e.base_)},setPrototypeOf(){u(12)}},p={};z(I,(e,r)=>{p[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});p.deleteProperty=function(e,r){return p.set.call(this,e,r,void 0)};p.set=function(e,r,t){return I.set.call(this,e[0],r,t,e[0])};function v(e,r){const t=e[s];return(t?l(t):e)[r]}function re(e,r,t){const n=X(r,t);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function X(e,r){if(!(r in e))return;let t=d(e);for(;t;){const n=Object.getOwnPropertyDescriptor(t,r);if(n)return n;t=d(t)}}function R(e){e.modified_||(e.modified_=!0,e.parent_&&R(e.parent_))}function D(e){e.copy_||(e.copy_=b(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var te=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(r,t,n)=>{if(typeof r=="function"&&typeof t!="function"){const o=t;t=r;const f=this;return function(a=o,...q){return f.produce(a,J=>t.call(this,J,...q))}}typeof t!="function"&&u(6),n!==void 0&&typeof n!="function"&&u(7);let i;if(_(r)){const o=j(this),f=M(r,void 0);let c=!0;try{i=t(f),c=!1}finally{c?k(o):E(o)}return x(o,n),K(i,o)}else if(!r||typeof r!="object"){if(i=t(r),i===void 0&&(i=r),i===B&&(i=void 0),this.autoFreeze_&&N(i,!0),n){const o=[],f=[];y("Patches").generateReplacementPatches_(r,i,o,f),n(o,f)}return i}else u(1,r)},this.produceWithPatches=(r,t)=>{if(typeof r=="function")return(f,...c)=>this.produceWithPatches(f,a=>r(a,...c));let n,i;return[this.produce(r,t,(f,c)=>{n=f,i=c}),n,i]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){_(e)||u(8),h(e)&&(e=ne(e));const r=j(this),t=M(e,void 0);return t[s].isManual_=!0,E(r),t}finishDraft(e,r){const t=e&&e[s];(!t||!t.isManual_)&&u(9);const{scope_:n}=t;return x(n,r),K(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,r){let t;for(t=r.length-1;t>=0;t--){const i=r[t];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}t>-1&&(r=r.slice(t+1));const n=y("Patches").applyPatches_;return h(e)?n(e,r):this.produce(e,i=>n(i,r))}};function M(e,r){const t=P(e)?y("MapSet").proxyMap_(e,r):O(e)?y("MapSet").proxySet_(e,r):ee(e,r);return(r?r.scope_:H()).drafts_.push(t),t}function ne(e){return h(e)||u(10,e),$(e)}function $(e){if(!_(e)||A(e))return e;const r=e[s];let t;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,t=b(e,r.scope_.immer_.useStrictShallowCopy_)}else t=b(e,!0);return z(t,(n,i)=>{G(t,n,$(i))}),r&&(r.finalized_=!1),t}var ie=new te,oe=ie.produce;export{h as a,_ as i,oe as p};
